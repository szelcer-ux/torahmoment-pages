<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>One minute audio לע&quot;נ הרב אברהם נתנאל צוקער ז&quot;ל</title>

<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#f6f7f9;margin:0;padding:18px;color:#111}
.wrap{max-width:980px;margin:0 auto}
h1{text-align:center;margin-bottom:4px}
.subtitle{text-align:center;font-size:1.1rem;color:#555;margin-bottom:16px}


:root{
  --bg:#f7f7f8;
  --card:#ffffff;
  --text:#111;
  --muted:#666;
  --border:#e7e7ee;
  --accent:#0d9488;
  --shadow:0 6px 22px rgba(0,0,0,0.07);
  --radius:16px;

  /* Per-page layout alignment (set these to match THAT page’s .wrap) */
  /* Example values below — change per page */
  --tm-wrap-max: 980px;
  --tm-wrap-pad: 0px;
}

 *, *::before, *::after{ box-sizing: border-box; }

 
/* ✅ Simple TorahMoment link under subtitle */
.brand{
  text-align:center;
  margin-top:-10px;
  margin-bottom:14px;
  font-size:12px;
  color:#888;
}
.brand a{
  color:inherit;
  text-decoration:none;
  border-bottom:1px dotted #c7cbd1;
}
.brand a:hover{
  color:#111;
  border-bottom-color:#111;
}

.bar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin:12px 0 14px}
input{flex:1;min-width:240px;padding:10px 12px;border:1px solid #d0d5dd;border-radius:10px;font-size:16px}
.pill{padding:8px 10px;background:#fff;border:1px solid #e5e7eb;border-radius:999px;font-size:14px}
.speed button{padding:6px 10px;border-radius:999px;border:1px solid #d0d5dd;background:#fff;cursor:pointer}
.speed button.active{font-weight:700}
.player{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:12px;box-shadow:0 2px 8px rgba(0,0,0,.06);margin-bottom:14px}
.now{font-size:14px;color:#444;margin-bottom:8px}
audio{width:100%}


.row.playing{outline:2px solid #111}
.meta{font-size:13px;color:#667085;margin-bottom:6px}
.desc{font-size:16px}

/* ✅ Gentle “modern” feel without changing layout */
.row{
  transition: transform .06s ease, box-shadow .12s ease;
}

.row:active{
  transform: scale(.99);
}

.head{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:nowrap;      /* ✅ never wrap to second line */
  width:100%;
}

.date{
  flex:0 0 auto;
  font-size:13px;
  color:#667085;
  white-space:nowrap;
}

.title{
  flex:1 1 auto;
  min-width:0;          /* ✅ CRITICAL: allows shrinking */
  font-size:15px;

  /* optional but recommended */
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;   /* ✅ force single line */
}


  
/* Compact mobile layout + tap-to-reveal speed buttons */
@media (max-width: 600px){
  body{padding:12px}
  .bar{gap:8px}
  input{width:100%; min-width:0}

  #sortBtn{padding:6px 10px}
  #count{padding:6px 10px}

  .row{padding:7px 9px; margin-bottom:5px}
  .meta{font-size:12px; margin-bottom:4px}
  .desc{font-size:15px; line-height:1.2}

  /* Hide speed buttons by default on mobile */
  .controls .speedBtns{display:none}

  /* Show when row is opened */
  .row.isOpen .controls .speedBtns{
    display:flex;
    gap:6px;
    flex-wrap:wrap;
    margin-top:8px;
  }

  .controls .speedBtns button{
    padding:5px 8px;
    font-size:13px;
  }

  audio{margin-top:6px}
}

/* ✅ Hide speed buttons by default everywhere */
.controls .speedBtns{display:none}

/* ✅ Show only when row is opened */
.row.isOpen .controls .speedBtns{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  margin-top:8px;
}

  .controls .speedBtns button{
  padding:6px 10px;
  font-size:13px;
  border-radius:999px;           /* ✅ fully rounded */
  border:1px solid #d0d5dd;
  background:#fff;
  cursor:pointer;
}
.controls .speedBtns button.active{
  font-weight:700;
  border-color:#111;
}

  .head{
  display:flex !important;
  flex-direction:row !important;
  flex-wrap:nowrap !important;
  align-items:center !important;
  gap:8px !important;
  width:100% !important;
}

.date{
  flex:0 0 auto !important;
  white-space:nowrap !important;
  font-size:13px;
  color:#667085;
}

.title{
  flex:1 1 auto !important;
  min-width:0 !important;          /* critical */
  white-space:nowrap !important;   /* force single line */
  overflow:hidden !important;
  text-overflow:ellipsis !important;
}

 .row{padding:10px}
audio{margin-top:6px}

/* ===== TorahMoment Topbar ===== */
.tm-topbar{
  width:100%;
  background:#ffffff;
  border-bottom:1px solid var(--border, #e7e7ee);
  position:sticky;
  top:0;
  z-index:1000;
  margin:0 !important;
}

.tm-topbar-inner{
  box-sizing: border-box; /* critical: match wrap sizing */
  max-width: var(--tm-wrap-max, 980px);
  margin:0 auto;
  padding:10px var(--tm-wrap-pad, 20px);
  display:flex;
  align-items:center;
  flex-wrap:nowrap;          /* never wrap */
  overflow-x:auto;           /* swipe on mobile */
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none;
  position:relative;         /* for fade overlay */
}

.tm-topbar-inner::-webkit-scrollbar{ display:none; }

/* right-edge fade hint */
.tm-topbar-inner::after{
  content:"";
  position:absolute;
  right:0;
  top:0;
  width:28px;
  height:100%;
  pointer-events:none;
  background:linear-gradient(to right, rgba(255,255,255,0), rgba(255,255,255,1));
}

/* links (force consistent color incl. visited) */
.tm-topbar a,
.tm-topbar a:visited{
  text-decoration:none;
  color:var(--muted, #666);
  font-size:14px;
  font-weight:500;
  white-space:nowrap;
  padding:4px 10px;
}

.tm-topbar a:hover{ color:var(--accent, #0d9488); }

/* Accessible active state: pill background (NOT color-only) */
/* Excludes home icon */
.tm-topbar a.active:not(.home-link),
.tm-topbar a.active:not(.home-link):visited{
  background: rgba(13,148,136,0.12);
  color: var(--text, #111) !important;
  font-weight: 600;
  border-radius: 999px;
}

/* separators */
.tm-topbar a + a{
  border-left:1px solid #e5e7eb;
  margin-left:6px;
  padding-left:12px;
}

/* home icon */
.tm-topbar .home-link{
  display:flex;
  align-items:center;
  justify-content:center;
  padding:4px 10px;
}
.tm-topbar .home-link svg{
  width:18px;
  height:18px;
}

/* Mobile tighten + “One Minute” -> “One-Min” */
@media (max-width: 520px){
  .tm-topbar-inner{ padding:8px var(--tm-wrap-pad, 12px); }
  .tm-topbar a, .tm-topbar a:visited{ font-size:13px; padding:3px 8px; }
  .tm-topbar a + a{ margin-left:5px; padding-left:10px; }

  .tm-topbar a[href$="/one-minute-audio.html"]{ font-size:0; }
  .tm-topbar a[href$="/one-minute-audio.html"]::before{
    content:"One-Min";
    font-size:13px;
  }
}

html, body{
  margin:0 !important;
  padding:0 !important;
}

  .listCard{
  margin-top: 12px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden; /* makes row dividers look clean */
}

#list .row{
  padding: 14px 16px;
  border-bottom: 1px solid var(--border);
}

#list .row:last-child{
  border-bottom: 0;
}

  

#list .date{
  font-size: 0.8rem;
  color: var(--muted);
  letter-spacing: 0.02em;
}

#list .title{
  font-weight: 600;
  font-size: 1rem;
}

 /* ===== Final row styling (rows are list items, NOT cards) ===== */
#list .row{
  background: transparent;
  border: 0;
  border-radius: 0;
  margin: 0;
  padding: 14px 16px;
  cursor: pointer;
  border-bottom: 1px solid var(--border);
  transition: background 120ms ease, transform 120ms ease;
}

#list .row:last-child{ border-bottom: 0; }

@media (hover:hover){
  #list .row:hover{
    background: rgba(0,0,0,0.02);
    transform: translateY(-1px);
  }
}

#list .row:active{ transform: scale(.995); } 

.controls .speedBtns button{
  border: 1px solid var(--border);
  background: #fff;
  border-radius: 999px;
}

.controls .speedBtns button.active{
  font-weight: 700;
  border-color: var(--accent);
  background: rgba(13,148,136,0.10);
  color: var(--text);
}

/* ===== FINAL: One-line row layout inside listCard ===== */

/* The outer card */
.listCard{
  margin-top: 12px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

/* Rows are NOT individual cards anymore */
#list .row{
  background: transparent;
  border: 0;
  border-radius: 0;
  margin: 0;
  padding: 7px 10px;   /* ✅ tighter */
  cursor: pointer;
  border-bottom: 1px solid var(--border);
  transition: background 120ms ease, transform 120ms ease;
}

#list .row:last-child{ border-bottom: 0; }

@media (hover:hover){
  #list .row:hover{
    background: rgba(0,0,0,0.02);
    transform: translateY(-1px);
  }
}

#list .row:active{ transform: scale(.995); }

/* One-line header: date + title */
#list .head{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:nowrap;
  width:100%;
  margin-bottom: 4px;
}

#list .date{
  flex:0 0 auto;
  font-size: 0.8rem;
  color: var(--muted);
  white-space:nowrap;
}

#list .title{
  flex:1 1 auto;
  min-width:0;
  font-size: 0.95rem;
  font-weight: 600;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Speed buttons: pill + accent active */
.controls .speedBtns button{
  padding:6px 10px;
  font-size:13px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  cursor:pointer;
}

.controls .speedBtns button.active{
  font-weight:700;
  border-color: var(--accent);
  background: rgba(13,148,136,0.10);
  color: var(--text);
}

/* Speed pill on right */
#list .speedOne{
  flex:0 0 auto;
  margin-left:auto;      /* pushes to far right */
  padding:4px 10px;
  font-size:12px;
  line-height:1;
  border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  color:var(--text);
  cursor:pointer;
}
#list .speedOne:active{ transform: scale(.98); }

/* ===== Mini player row (matches screenshot vibe) ===== */
#list .tmPlayer{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
}

#list .tmPlay{
  width:36px;
  height:36px;
  border-radius:999px;
  border:1px solid var(--border);
  background:#fff;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  line-height:1;
}

#list .tmSeek{
  flex:1 1 auto;
  min-width:0;
}

#list .tmSpeed{
  border:1px solid var(--border);
  background:#fff;
  border-radius:999px;
  padding:4px 10px;
  font-size:12px;
  cursor:pointer;
  line-height:1;
}

#list .tmTime{
  font-size:12px;
  color:var(--muted);
  width:44px;
  text-align:right;
  font-variant-numeric: tabular-nums;
}
  
</style>
</head>

<body>

<div class="tm-topbar">
  <div class="tm-topbar-inner">
    <a href="https://torahmoment.com" aria-label="Home" class="home-link">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 10.5L12 3l9 7.5"></path>
        <path d="M5 10v10h14V10"></path>
      </svg>
    </a>

    <a href="https://torahmoment.com/parsha.html">Parsha</a>
    <a href="https://torahmoment.com/halacha.html">Halacha</a>
    <a href="https://torahmoment.com/one-minute-audio.html">One Minute</a>
    <a href="https://torahmoment.com/tefilah.html">Tefila</a>
    <a href="https://torahmoment.com/mishna.html">Mishna</a>
  </div>
</div>

 
<div class="wrap">

<h1>One minute audio</h1>
<div class="subtitle">לע״נ הרב אברהם נתנאל צוקער זצ״ל</div>

<div class="bar">
  <input id="q" placeholder="Search…" />
  <button class="pill" id="sortBtn">Latest ↓</button>
  <div class="pill" id="count">0 items</div>
</div>

<div class="listCard">
  <div id="list"></div>
</div>
</div>

<!-- ✅ Keep this ONCE (and in the right place) -->
<script src="/data/site-counts.js"></script>

<script>
const DATA_URL = "./data.json";

const q = document.getElementById("q");
const list = document.getElementById("list");
const count = document.getElementById("count");
const sortBtn = document.getElementById("sortBtn");

let items = [];
let filtered = [];
let sortLatestFirst = true;

function pauseAllExcept(current){
  document.querySelectorAll("audio").forEach(a=>{
    if (a !== current) a.pause();
  });
}

function esc(s){
  return (s||"").replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))
}

function getSavedRate(){
  return Number(localStorage.getItem("rate") || "1");
}
function setSavedRate(r){
  localStorage.setItem("rate", String(r));
}

/* ✅ Sort uses precomputed _sortKey */
function sortItems(){
  filtered.sort((a,b)=> sortLatestFirst ? (b._sortKey - a._sortKey) : (a._sortKey - b._sortKey));
}

function render(){
  sortItems();
  list.innerHTML = "";
  count.textContent = filtered.length + " items";

  // ✅ Feed the site-wide counter (for the GitHub Action JSON build)
  if (window.SITE_COUNTS?.allShiurim?.breakdown) {
    window.SITE_COUNTS.allShiurim.breakdown.oneMinute.audio = filtered.length;
    window.SITE_COUNTS.allShiurim.updated = new Date().toISOString().slice(0, 10);
  }

  const defaultRate = getSavedRate();

  filtered.forEach(it=>{
    const row = document.createElement("div");
    row.className = "row";

    row.innerHTML = `
      <div class="head">
        <div class="date">${esc(it.date)}</div>
        <div class="title">${esc(it.description)}</div>
      </div>

      <div class="tmPlayer" data-id="${it.id}">
        <button class="tmPlay" type="button" aria-label="Play/Pause">▶</button>
        <input class="tmSeek" type="range" min="0" max="1000" value="0" aria-label="Seek" />
        <button class="tmSpeed" type="button" aria-label="Playback speed">${defaultRate}×</button>
        <div class="tmTime" aria-label="Time">0:00</div>

        <!-- hidden audio element that actually plays -->
        <audio class="tmAudio" preload="none" data-audio-id="${it.id}">
          <source src="${esc(it.url)}" type="audio/mpeg">
        </audio>
      </div>
    `;

    list.appendChild(row);

    // Elements
    const player = row.querySelector(".tmPlayer");
    const audioEl = row.querySelector(`audio.tmAudio[data-audio-id="${it.id}"]`);
    const playBtn = row.querySelector(".tmPlay");
    const seekEl = row.querySelector(".tmSeek");
    const speedBtn = row.querySelector(".tmSpeed");
    const timeEl = row.querySelector(".tmTime");

    // Apply saved speed immediately
    if (audioEl) audioEl.playbackRate = defaultRate;
    if (speedBtn) speedBtn.textContent = `${defaultRate}×`;

    // Helper: mm:ss
    function fmtTime(sec){
      sec = Math.max(0, sec || 0);
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${String(s).padStart(2,"0")}`;
    }

    // Clicking row (outside player controls) can still open/close if you want
    row.addEventListener("click", (e) => {
      if (e.target.closest(".tmPlayer")) return;
      row.classList.toggle("isOpen");
    });

    // Play/pause button
    playBtn?.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();

      if (!audioEl) return;

      if (audioEl.paused) {
        pauseAllExcept(audioEl);
        audioEl.playbackRate = getSavedRate() || 1;
        audioEl.play().catch(()=>{});
      } else {
        audioEl.pause();
      }
    });

const SPEEDS = [1, 1.25, 1.5, 2];

function fmtTime(sec){
  sec = Math.max(0, sec || 0);
  const m = Math.floor(sec / 60);
  const s = Math.floor(sec % 60);
  return `${m}:${String(s).padStart(2,"0")}`;
}

function nextSpeed(cur){
  const i = SPEEDS.indexOf(cur);
  return SPEEDS[(i >= 0 ? i + 1 : 0) % SPEEDS.length];
}

function ensureSrc(audio){
  // If you ever move to data-src lazy load, you can put it here.
  // For now, source is already in HTML.
}

list.addEventListener("click", (e) => {
  const player = e.target.closest(".tmPlayer");
  if (!player) return;

  const audio = player.querySelector("audio.tmAudio");
  if (!audio) return;

  // Play/pause
  if (e.target.closest(".tmPlay")) {
    ensureSrc(audio);

    if (audio.paused) {
      pauseAllExcept(audio);
      audio.playbackRate = getSavedRate();
      audio.play().catch(()=>{});
    } else {
      audio.pause();
    }
    return;
  }

  // Speed
  if (e.target.closest(".tmSpeed")) {
    const btn = player.querySelector(".tmSpeed");
    const cur = Number(audio.playbackRate) || getSavedRate() || 1;
    const rate = nextSpeed(cur);

    audio.playbackRate = rate;
    setSavedRate(rate);
    btn.textContent = `${rate}×`;
    return;
  }
});

// Seek bar interactions
list.addEventListener("input", (e) => {
  const seek = e.target.closest(".tmSeek");
  if (!seek) return;

  const player = seek.closest(".tmPlayer");
  const audio = player?.querySelector("audio.tmAudio");
  if (!audio || !isFinite(audio.duration) || audio.duration <= 0) return;

  const pct = Number(seek.value) / 1000;
  audio.currentTime = pct * audio.duration;
});

// Keep UI updated
list.addEventListener("timeupdate", () => {}); // (no-op; timeupdate doesn't bubble reliably)


// Seek bar interactions
list.addEventListener("input", (e) => {
  const seek = e.target.closest(".tmSeek");
  if (!seek) return;

  const player = seek.closest(".tmPlayer");
  const audio = player?.querySelector("audio.tmAudio");
  if (!audio || !isFinite(audio.duration) || audio.duration <= 0) return;

  const pct = Number(seek.value) / 1000;
  audio.currentTime = pct * audio.duration;
});

// Keep UI updated
list.addEventListener("timeupdate", () => {}); // (no-op; timeupdate doesn't bubble reliably)
  
</script>

<!-- (Optional) You can remove this whole block if you don't use ONE_MINUTE_AUDIO vars.
     Your main render() already updates SITE_COUNTS based on filtered.length -->
<script>
(function updateOneMinuteCount() {
  if (!window.SITE_COUNTS?.allShiurim?.breakdown) return;

  function countAllItems(obj) {
    if (!obj) return 0;
    if (Array.isArray(obj)) return obj.length;
    if (typeof obj === "object") {
      return Object.values(obj).reduce((sum, v) => sum + (Array.isArray(v) ? v.length : 0), 0);
    }
    return 0;
  }

  const oneMinuteItems =
    (typeof ONE_MINUTE_AUDIO !== "undefined") ? ONE_MINUTE_AUDIO :
    (typeof ONE_MINUTE_LIST !== "undefined") ? ONE_MINUTE_LIST :
    (typeof AUDIO_ITEMS !== "undefined") ? AUDIO_ITEMS :
    null;

  const total = countAllItems(oneMinuteItems);

  window.SITE_COUNTS.allShiurim.breakdown.oneMinute.audio = total;
  window.SITE_COUNTS.allShiurim.updated = new Date().toISOString().slice(0,10);

  console.log("✅ Updated One-Minute count:", total);
})();
</script>

<script>
(function(){
  const q = (new URLSearchParams(location.search).get("q") || "").trim();
  if(!q) return;

  // try common search inputs used on your pages
  const input =
    document.querySelector("#searchInput") ||
    document.querySelector("#q") ||
    document.querySelector('input[type="search"]');

  if(!input) return;

  input.value = q;
  input.dispatchEvent(new Event("input", { bubbles:true }));
})();
</script>

<script>
(function applyGlobalSearchOneMinute(){
  const params = new URLSearchParams(location.search);
  const q = (params.get("q") || "").trim();
  if (!q) return;

  function fire() {
    const inp = document.getElementById("q");
    if (!inp) return false;

    inp.value = q;

    // trigger your existing input listener
    inp.dispatchEvent(new Event("input", { bubbles: true }));
    inp.dispatchEvent(new Event("change", { bubbles: true }));

    // if your page has a known function, call it too (safe if missing)
    if (typeof window.applyFilters === "function") window.applyFilters();
    if (typeof window.render === "function") window.render();

    return true;
  }

  // 1) try immediately
  fire();

  // 2) try after DOM is ready
  window.addEventListener("DOMContentLoaded", () => {
    fire();
    setTimeout(fire, 100);
    setTimeout(fire, 350);
    setTimeout(fire, 800);
  });

  // 3) try after everything is loaded (JSON fetches etc. often finish by then)
  window.addEventListener("load", () => {
    fire();
    setTimeout(fire, 150);
  });
})();
</script>

<script>
(function(){
  const links = document.querySelectorAll(".tm-topbar a[href]:not(.home-link)");
  const raw = (location.pathname || "/").replace(/\/+$/, "") || "/";
  const current = (raw === "/index.html") ? "/" : raw;

  links.forEach(a => {
    const u = new URL(a.getAttribute("href"), location.href);
    const lpRaw = (u.pathname || "/").replace(/\/+$/, "") || "/";
    const lp = (lpRaw === "/index.html") ? "/" : lpRaw;

    if (lp === current) a.classList.add("active");
  });
})();
</script>


  
</body>
</html>
