<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Halacha/Hashkafah</title>

  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#0b63ce;
      --accent2:#0752ad;
      --chip:#eef2ff;
      --shadow: 0 10px 25px rgba(0,0,0,.06);
      --radius: 16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header{
      padding: 28px 18px 10px;
      text-align:center;
    }
    header h1{
      margin:0;
      font-size: 2rem;
      letter-spacing: .2px;
      color: var(--text);
    }
    header p{
      margin: 10px auto 0;
      max-width: 880px;
      color: var(--muted);
      line-height: 1.45;
    }

    .container{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
    }

    .topbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      margin: 12px 0 22px;
    }

    .search{
      flex: 1 1 420px;
      max-width: 560px;
      position: relative;
    }
    .search input{
      width:100%;
      padding: 12px 14px;
      border:1px solid var(--line);
      border-radius: 999px;
      outline:none;
      font-size: 15px;
      background: #fff;
      box-shadow: 0 1px 0 rgba(0,0,0,.02);
    }

    .chip{
      background: var(--chip);
      color: var(--accent2);
      border: 1px solid #dbe3ff;
      padding: 7px 12px;
      border-radius: 999px;
      font-size: 13px;
      white-space: nowrap;
    }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      margin-bottom: 14px;
    }

    details.category{
      padding: 0;
    }

    details.category > summary{
      list-style:none;
      padding: 16px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      user-select:none;
      cursor: default; /* not clicky */
    }

    details.category > summary::-webkit-details-marker{display:none}

    .cat-title{
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent2);
    }

    .count{
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--line);
      background: #fafafa;
      padding: 4px 10px;
      border-radius: 999px;
    }

    .content{
      border-top: 1px solid var(--line);
      padding: 14px 16px 16px;
    }

.helper-text{
  margin-top: 8px;
  font-size: 13px;
  color: var(--muted);
  text-align: center;
}

    
    .subgrid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 12px;
    }

    details.subcat{
      background: #fbfcff;
      border:1px solid var(--line);
      border-radius: 14px;
      overflow:hidden;
    }
    details.subcat > summary{
      list-style:none;
      padding: 12px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      user-select:none;
      font-weight: 650;
      color:#0f3f7a;
      cursor: default; /* not clicky */
    }
    details.subcat > summary::-webkit-details-marker{display:none}

    .items{
      border-top: 1px solid var(--line);
      padding: 10px 12px 12px;
    }

    .item{
      border:1px solid var(--line);
      background:#fff;
      border-radius: 12px;
      padding: 10px 10px;
      margin: 8px 0;
    }

    .item-meta{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items: baseline;
      flex-wrap:wrap;
      margin-bottom: 6px;
    }

    .item-title{
      font-weight: 700;
      font-size: 14px;
    }
    .item-note{
      color: var(--muted);
      font-size: 12px;
    }

.tm-note-row{
  display:flex;
  align-items:center;
  gap:10px;
  border:1px dashed var(--line);
  background:#f8fafc;
  border-radius: 14px;
  padding: 12px 14px;
  font-size: 13px;
  cursor: pointer;
}

.tm-note-row .icon{
  font-size: 18px;
}

.tm-note-row a{
  color: var(--accent);
  text-decoration: none;
  font-weight: 600;
}

.tm-note-row a:hover{
  text-decoration: underline;
}

    .tm-note-row:hover{
  background: #eef2ff;
}

.tm-link-row .tm-play{
  color: #dc2626; /* subtle red hint = YouTube */
}

    .tm-row.tm-youtube{
  border-style: dashed;
  background: #fcfcff;
}

.tm-speed{
  border: 1px solid var(--line);
  background: #f9fafb;
  border-radius: 999px;
  padding: 6px 10px;
  font-size: 12px;
  font-weight: 600;
  color: #374151;
  cursor: pointer;
  user-select: none;
}


    
    audio{
      width:100%;
      margin-top: 6px;
    }

    .link{
      display:inline-block;
      margin-top: 6px;
      font-size: 13px;
      color: var(--accent);
      text-decoration: none;
    }
    .link:hover{ text-decoration: underline; }

    .empty{
      color: var(--muted);
      font-size: 13px;
      padding: 8px 0 0;
    }

    /* Responsive YouTube embed */
    .video-wrap{
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 */
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--line);
      background: #000;
      margin-top: 8px;
    }
    .video-wrap iframe{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
    }

    footer{
      text-align:center;
      color: var(--muted);
      padding: 18px;
      font-size: 12px;
    }

.tm-badge{
  font-size: 12px;
  padding: 5px 10px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: #f8fafc;
  color: #374151;
  white-space: nowrap;
}

    .tm-len.tm-short{
  background:#ecfeff;
  border-color:#a5f3fc;
  color:#155e75;
}
.tm-len.tm-long{
  background:#fff7ed;
  border-color:#fed7aa;
  color:#9a3412;
}

    
/* --- TorahMoment-style custom audio player --- */
.tm-player{
  display:flex;
  align-items:center;
  gap:10px;
  border:1px solid var(--line);
  background:#f9fafb;
  border-radius: 14px;
  padding: 10px 12px;
}

.tm-btn{
  width:42px;
  height:42px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff;
  cursor:pointer;
  font-weight:800;
  color: var(--accent2);
}

.tm-seek{
  flex:1;
  height: 4px;
}

.tm-time{
  min-width: 96px;
  text-align:right;
  font-size: 12px;
  color: var(--muted);
  font-variant-numeric: tabular-nums;
}

.tm-meta{
  display:flex;
  justify-content:space-between;
  gap:10px;
  align-items: baseline;
  flex-wrap:wrap;
  margin-bottom: 8px;
}

.tm-title{
  font-weight: 650;
  font-size: 14px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
   cursor: default;
}
.tm-title::after{
  content: attr(title);
  display: none;
}

/* Mobile title expand */
.tm-title{
  cursor: pointer;
}

.tm-title.expanded{
  white-space: normal;
  overflow: visible;
  text-overflow: unset;
}

/* Only allow tap-to-expand on small screens */
@media (min-width: 768px){
  .tm-title{
    cursor: default;
  }
}

@media (max-width: 767px){
  header p{
    display: none;
  }
}

.tm-note{
  color: var(--muted);
  font-size: 12px;
}

.tm-title-row{
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 12px;
  margin-bottom: 6px;
}

.tm-title-row .tm-title{
  font-weight: 650;
  font-size: 14px;
  flex: 1 1 auto;
}

.tm-title-row .tm-note{
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
  flex: 0 0 auto;
}

    
/* --- Playlist-row player (matches your screenshot style) --- */
.item{
  padding: 0;
  border: 0;
  background: transparent;
  margin: 10px 0;
}

.tm-row{
  display:flex;
  align-items:center;
  gap: 12px;
  border: 1px solid var(--line);
  background: #fff;
  border-radius: 14px;
  padding: 12px 14px;
}

.tm-row{
  cursor: pointer;
}
.tm-row:hover{
  box-shadow: 0 6px 16px rgba(0,0,0,.05);
}

    
.tm-play{
  width: 42px;
  height: 42px;
  border-radius: 999px;
  border: 1px solid var(--line);
  background: #fff;
  cursor: pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight: 900;
  color: var(--accent2);
  flex: 0 0 auto;
}

.tm-main{
  flex: 1 1 auto;
  min-width: 0;
}

.tm-title{
  font-weight: 650;
  font-size: 14px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.tm-right{
  display:flex;
  align-items:center;
  gap: 10px;
  flex: 0 0 auto;
}

.tm-dur{
  color: var(--muted);
  font-size: 12px;
  font-variant-numeric: tabular-nums;
}


/* Optional: thin progress line like a modern playlist */
.tm-progress{
  height: 3px;
  background: #eef2f7;
  border-radius: 999px;
  margin-top: 8px;
  overflow:hidden;
}
.tm-progress > div{
  height: 100%;
  width: 0%;
  background: var(--accent);
  border-radius: 999px;
}

.brand{
  text-align:center;
  margin-top:-10px;
  margin-bottom:14px;
  font-size:12px;
  color:#888;
}
.brand a{
  color:inherit;
  text-decoration:none;
  border-bottom:1px dotted #c7cbd1;
}
.brand a:hover{
  color:#111;
  border-bottom-color:#111;
}

    /* =========================
   Mobile polish ‚Äì halacha
   ========================= */
@media (max-width: 640px) {

 
  /* cards closer together */
  .card {
    margin-bottom: 10px;
    border-radius: 10px;
  }

  /* category header more compact */
  .category > summary {
    padding: 8px 10px;
    font-size: 0.95rem;
  }

  /* subcategories less tall */
  .subcat > summary {
    padding: 6px 8px;
    font-size: 0.9rem;
  }

  /* shrink item rows */
  .items {
    gap: 6px;
  }

  /* each shiur row tighter */
  .item,
  .row,
  .audioRow,
  .ytRow,
  .noteRow {
    padding: 6px 8px;
    font-size: 0.92rem;
  }

  /* reduce title wrapping height */
  .item-title,
  .title {
    line-height: 1.2;
  }

  /* smaller counters */
  .count {
    font-size: 0.8rem;
    opacity: 0.8;
  }

  /* result chip less bulky */
  #resultChip {
    font-size: 0.85rem;
    padding: 6px 8px;
  }

/* ‚úÖ these are the big spacers on your page */
header{
  padding: 16px 12px 6px;
}
header h1{
  font-size: 1.55rem;
}

.container{
  padding: 10px;
}
.topbar{
  margin: 8px 0 12px;
}
.search input{
  padding: 10px 12px;
  font-size: 14px;
}

  /* ‚úÖ the rows that actually make the page tall */
.tm-row{
  padding: 10px 10px;
  gap: 10px;
  border-radius: 12px;
}
.tm-play{
  width: 38px;
  height: 38px;
}
.tm-right{
  gap: 8px;
}
.tm-dur{
  font-size: 11px;
}
.tm-title{
  font-size: 13px;
}

  .subgrid{
  grid-template-columns: 1fr;
  gap: 10px;
}
.content{
  padding: 10px 10px 12px;
}
.items{
  padding: 8px 10px 10px;
}

    /* less space between subcategory cards */
  .subgrid{
    gap: 8px;
  }

  /* less padding inside each subcategory box */
  .items{
    padding: 6px 8px 8px;
  }

  /* less vertical margin between rows */
  .item{
    margin: 4px 0;
  }

  /* shrink each playable row slightly */
  .tm-row{
    padding: 8px 10px;
  }

  /* tighter subcategory header */
  details.subcat > summary{
    padding: 6px 8px;
  }

  /* slightly tighter title spacing */
  .tm-title-row{
    margin-bottom: 4px;
  }
  .tm-row{
  border-radius: 10px;
}
.tm-play{
  width: 34px;
  height: 34px;
}
.tm-divider{ margin: 6px 2px; font-size: 11px; }

}
.chip{
  padding: 6px 10px;
  font-size: 12px;
}

    .tm-divider{
  display:flex;
  align-items:center;
  gap:10px;
  margin: 10px 2px;
  color: var(--muted);
  font-size: 12px;
  font-weight: 800;
  letter-spacing: .2px;
  text-transform: uppercase;
}
.tm-divider::before,
.tm-divider::after{
  content:"";
  height:1px;
  background: var(--line);
  flex: 1 1 auto;
}
.tm-divider span{
  padding: 0 6px;
  white-space: nowrap;
}

/* =========================
   Desktop typography polish
   ========================= */
@media (min-width: 768px){

  .cat-title{
    color: var(--text); /* normal dark */
  }

  details.subcat > summary{
    color: var(--text);
    font-weight: 650;
  }

  .count{
    color: var(--muted);
  }
}

    /* =========================
   Desktop focus mode
   ========================= */
@media (min-width: 768px){

  /* when open ‚Üí full width focus */
  details.subcat[open]{
    grid-column: 1 / -1;
  }

  /* slightly highlight focused panel */
  details.subcat[open]{
    box-shadow: 0 10px 25px rgba(0,0,0,.08);
    background: #fff;
  }

  /* show it's clickable */
  details.subcat > summary{
    cursor: pointer;
  }
}

    
  </style>
  
</head>

<body>
  <header>
    <h1>Halacha/Hashkafah</h1>
    &nbsp;
    <div class="brand">
  <a href="https://torahmoment.com" rel="noopener">TorahMoment.com</a>
</div>

    <div id="helperText" class="helper-text">
 Please note that nothing on this page should be taken as psak din and all questions should be addressed to a trusted Rabbi.
</div>
  </header>

  <div class="container">
    <div class="topbar">
      <div class="search">
        <input id="searchInput" type="text" placeholder="Search (e.g., Shema, Purim, Tzedakah)..." />
      </div>
      <div class="chip" id="resultChip">Showing all</div>
    </div>

    <!-- ===================== -->
    <!-- DATA (Edit here only) -->
    <!-- ===================== -->
    <script>
      // HOW TO ADD ITEMS:
      // Add objects inside any "items: []" list.
      //
      // AUDIO (inline player):
      // { type:"audio", title:"Title", url:"https://...mp3", note:"Optional" }
      //
      // YOUTUBE (embedded):
      // { type:"youtube", title:"Title", url:"https://www.youtube.com/watch?v=VIDEOID", note:"Optional" }

      const PAGE_DATA = [
        {
          category: "Tefilah",
          subcategories: [
            {
              name: 'Talis/Tefilin',items: [
                {type: "audio",title: "Double Black Tefilin", url: "https://www.buzzsprout.com/1899789/episodes/18540770-1-20-2025-shloimy-zelcer-double-black-tefilin.mp3", note: "1/20/2026"},
                {type: "audio",title: "Stripes on the Talis", url: "https://www.buzzsprout.com/1899789/episodes/16448331-1-16-2025-shloimy-zelcer-stripes-on-the-talis.mp3", note: "1/16/2025"},
                {type: "audio",title: "Women and the mitzvah of Tefillin", url: "https://2mishnasaday.com/wp-content/uploads/womentefilin.mp3", note: "6/30/2022"},
                {type: "audio",title: "History of techeiles", url: "https://2mishnasaday.com/wp-content/uploads/techeileshistory.mp3", note: "8/5/2021"},
                {type: "audio",title: "Why don't people wear techeiles", url: "https://2mishnasaday.com/wp-content/uploads/techeileswhynot.mp3", note: "7/29/2021"},
                 {type: "note", text: "Article in Hakirah regarding Atifas Tallis", linkText: "View article", url: "https://hakirah.org/Vol%207%20BergerZelcer.pdf"}
              ]  },
            { name: 'Shema/Shmoneh Esrei', items: [
              {type: "audio",title: "Standing up to say Krias Shema", url: "https://www.buzzsprout.com/1899789/episodes/17508580-7-15-2025-shloimy-zelcer-standing-up-to-say-kriyas-shema.mp3", note: "7/15/2025"},
              {type: "audio",title: "Do you have to know what youre saying in davening?", url: "https://www.buzzsprout.com/1899789/episodes/17665749-8-13-2025-shloimy-zelcer-do-you-have-to-know-what-youre-saying-in-davening.mp3", note: "8/13/2025"},
              {type: "audio",title: "Answering Baruch Hu Uvaruch Shemo", url: "https://www.buzzsprout.com/1899789/episodes/17240722-5-28-2025-shloimy-zelcer-answering-baruch-hu-uvaruch-shemo.mp3", note: "5/28/2025"},
              {type: "audio",title: "Answering Amen to ◊í÷º÷∏◊ê÷∑◊ú ◊ô÷¥◊©◊Ç÷∞◊®÷∏◊ê÷µ◊ú", url: "https://www.buzzsprout.com/1899789/episodes/16829518-3-26-2025-shloimy-zelcer-answering-amen-to.mp3", note: "3/26/2025"},
              {type: "note", text: "For an explanation of each bracha of Shemoneh Esrei, see this playlist.", linkText: "View playlist", url: "https://torahmoment.com/tefilah.html"}
            ] },
            { name: 'Krias Hatorah', items: [
              {type: "audio",title: "Asking a kohen to leave", url: "https://www.buzzsprout.com/1899789/episodes/16170138-11-25-2024-shloimy-zelcer-asking-a-kohen-to-leave.mp3", note: "11/25/2024"},
              {type: "audio",title: "Who gets the first aliyah when there is no kohen", url: "https://www.buzzsprout.com/1899789/episodes/16134190-11-19-2024-shloimy-zelcer-who-gets-the-first-aliyah-when-there-is-no-kohen.mp3", note: "11/19/2024"},
               {type: "audio",title: "Standing for Aseres Hadibros", url: "https://2mishnasaday.com/wp-content/uploads/standingasereshadibros.mp3", note: "1/29/2026"}
            ] },
            { name: 'Kadish', items: [
              {type: "audio",title: "Women saying Kadish", url: "https://www.buzzsprout.com/1899789/episodes/17345373-6-16-2025-shloimy-zelcer-women-saying-kadish.mp3", note: "6/16/2025"}
            ] },
            { name: 'Other Tefilos', items: [
               {type: "audio",title: "Daven to Hashem, not angels", url: "https://www.buzzsprout.com/1899789/episodes/18285871-12-3-2025-shloimy-zelcer-daven-to-hashem-not-angels.mp3", note: "12/3/2025"},
               {type: "audio",title: "Tefilas Haderech", url: "https://www.buzzsprout.com/1899789/episodes/17012786-4-21-2025-shloimy-zelcer-tefilas-haderech.mp3", note: "4/21/2025"},
               {type: "audio",title: "◊ì÷º÷∏◊ï÷¥◊ì ◊û÷∂◊ú÷∂◊ö÷∞ ◊ô÷¥◊©◊Ç÷∞◊®÷∏◊ê÷µ◊ú ◊ó÷∑◊ô ◊ï÷∞◊ß÷∑◊ô÷º÷∏◊ù ◊ë◊ß◊ô◊ì◊ï◊© ◊ú◊ë◊†◊î", url: "https://www.buzzsprout.com/1899789/episodes/16554683-2-3-2025-shloimy-zelcer.mp3", note: "2/3/2025"},
              {type: "audio",title: "Why Don't women say Kiddush Levanah?", url: "https://2mishnasaday.com/wp-content/uploads/womenkiddushlevana.mp3", note: "3/11/2021"}
            ] },
            { name: 'Behavior', items: [
               {type: "audio",title: "When Davening takes too long", url: "https://www.buzzsprout.com/1899789/episodes/18082159-10-28-2025-shloimy-zelcer-when-davening-takes-too-long.mp3", note: "10/28/2025"},
               {type: "audio",title: "Kiddush in middle of davening?", url: "https://www.buzzsprout.com/1899789/episodes/17430394-7-1-2025-shloimy-zelcer-kiddush-in-middle-of-davening.mp3", note: "7/1/2025"},
              {type: "audio",title: "Head covering during prayer", url: "https://www.buzzsprout.com/1899789/episodes/10438736-4-12-2022-shloimy-zelcer.mp3", note: "4/12/2022"},
              {type: "audio",title: "Praying with a minyan", url: "https://2mishnasaday.com/wp-content/uploads/minyanzoom.mp3", note: "6/4/2020"}
            ] }
          ]
        },

        {
          category: "Shabbos/Yom Tov",
          subcategories: [
             { name: 'Shabbos', items: [
              {type: "audio",title: "Covering challah during kiddush Part 2", url: "https://www.buzzsprout.com/1899789/episodes/18577857-1-28-2026-shloimy-zelcer-covering-challah-during-kiddush-part-2.mp3", note: "1/28/2026"},
              {type: "audio",title: "Covering challah during kiddush", url: "https://www.buzzsprout.com/1899789/episodes/18577841-1-27-2026-shloimy-zelcer-covering-challah-during-kiddush.mp3", note: "1/27/2026"}
            ] },
            { name: 'Elul/Tishrei', items: [
            { type: "note", noteStyle: "divider", text: "Rosh Hashana" },
              {type: "audio",title: "Parshas Nitzavim / Erev Rosh Hashana", url: "https://2mishnasaday.com/wp-content/uploads/Nitzavim.mp3", note: "9/18/2025"},
               {type: "audio",title: "Teshuva - returning home", url: "https://www.buzzsprout.com/1899789/episodes/15721287-9-9-2024-shloimy-zelcer-teshuva-returning-home.mp3", note: "9/9/2024"},
              {type: "audio",title: "Teshuva like snow and laundry", url: "https://www.buzzsprout.com/1899789/episodes/14272565-1-8-2024-shloimy-zelcer.mp3", note: "1/8/2024"},
              {type: "audio",title: "Simanim of Rosh Hashana", url: "https://2mishnasaday.com/wp-content/uploads/simaneiroshhashanaMP3.mp3", note: "9/16/2020"},
            { type: "note", noteStyle: "divider", text: "Yom Kippur" },
              {type: "audio",title: "Yom Kippur through the ages", url: "https://2mishnasaday.com/wp-content/uploads/yomkippurthroughtheages.mp3", note: "9/23/2020"},
            { type: "note", noteStyle: "divider", text: "Sukkos" },
              {type: "audio",title: "The importance of the Aravos", url: "https://www.buzzsprout.com/1899789/episodes/15931239-10-15-2024-shloimy-zelcer-the-importance-of-the-aravos.mp3", note: "10/15/2024"},
              { type:"youtube", title:"Sukkah heals our wounds", url:"https://youtu.be/qI8KKe3om1c", note:"9/28/2023"}
            ] },
            { name: 'Chanukah', items: [
              {type: "audio",title: "8 lesser known answers to the famous question of the Beis Yosef", url: "https://www.buzzsprout.com/1899789/episodes/11906323-12-20-2022-shloimy-zelcer.mp3", note: "12/20/2022"},
              { type:"youtube", title:"A little at a time", url:"https://youtu.be/ScsMi-d0qHs", note:"11/30/2021" },
              { type:"youtube", title:"Chanukah thought", url:"https://youtu.be/gzQiPo2JKT8", note:"12/24/2019" }
            ] },
            { name: 'Purim', items: [
              {type: "audio",title: "Three lesser discussed halachos regarding Purim", url: "https://www.buzzsprout.com/1899789/episodes/10184217-3-3-2022-shloimy-zelcer.mp3", note: "3/3/2022"},
              { type:"youtube", title:"Purim thoughts", url:"https://youtu.be/4ZhRg40--g8", note:"3/20/2019" }
            ] },
            { name: 'Yimei Sefirah', items: [
             { type: "note", noteStyle: "divider", text: "Pesach" },
              {type: "audio",title: "Reframing the Pesach Seder", url: "https://2mishnasaday.com/wp-content/uploads/PESACHPRESHIUR.mp3", note: "4/10/2025"},
              {type: "audio",title: "An alternate look at the 10 makkos", url: "https://2mishnasaday.com/wp-content/uploads/10makkosnewlight.mp3", note: "3/23/2023"},
              {type: "audio",title: "Korban Pesach today", url: "https://2mishnasaday.com/wp-content/uploads/korbanpesachtoday.mp3", note: "4/7/2022"},
              {type: "audio",title: "Let my people go", url: "https://2mishnasaday.com/wp-content/uploads/letmypeoplego.mp3", note: "1/13/2022"},
              {type: "audio",title: "Historical Perspective on the Five Sages in the Haggadah", url: "https://2mishnasaday.com/wp-content/uploads/5sageshagadah.mp3", note: "3/18/2021"},
              {type:"youtube", title:"The perfect child", url:"https://youtu.be/hLOR9lvtuUE", note:"4/17/2019" },
              { type: "note", noteStyle: "divider", text: "Sefirah" },
              {type: "audio",title: "Evolution of the days of Sefirah", url: "https://2mishnasaday.com/wp-content/uploads/historyofsefirah.mp3", note: "2/26/2022"},
               {type: "note", noteStyle: "divider", text: "Lag Ba'omer" },
              {type: "audio",title: "A Lesson from Lag Baomer", url: "https://www.buzzsprout.com/1899789/episodes/15124705-5-23-2024-shloimy-zelcer-a-lesson-from-lag-baomer.mp3", note: "5/23/2024"},
              {type: "audio",title: "Customs of Lag Baomer", url: "https://2mishnasaday.com/wp-content/uploads/LagBaomerZoom.mp3", note: "5/21/2020"},
              { type: "note", noteStyle: "divider", text: "Shavuos" },
              {type: "audio",title: "Staying awake all Shavuos night", url: "https://2mishnasaday.com/wp-content/uploads/stayingupshavuosnight.mp3", note: "5/18/2023"}
            ] },
          ]
        },
        { category: "Talmud Torah", items: [
              {type: "audio",title: "History of Kollel", url: "https://2mishnasaday.com/wp-content/uploads/historyofkollel.mp3", note: "12/25/2025"},
              {type: "audio",title: "Various aspects of talmud torah", url: "https://www.buzzsprout.com/1899789/episodes/15494012-7-30-2024-shloimy-zelcer-various-aspects-of-talmud-torah.mp3", note: "7/30/2024"},
              {type: "audio",title: "◊ê◊ú◊ï ◊ï◊ê◊ú◊ï ◊ì◊ë◊®◊ô ◊ê◊ú◊ß◊ô◊ù ◊ó◊ô◊ô◊ù", url: "https://www.buzzsprout.com/1899789/episodes/15026066-5-7-2024-shloimy-zelcer.mp3", note: "5/7/2024"},
              {type: "audio",title: "Learning the written and oral Torah", url: "https://www.buzzsprout.com/1899789/episodes/14864486-4-10-2024-shloimy-zelcer-learning-the-written-and-oral-torah.mp3", note: "4/10/2024"},
              {type: "audio",title: "Defining Torah Shebaal Peh", url: "https://www.buzzsprout.com/1899789/episodes/14763027-3-25-2024-shloimy-zelcer-defining-torah-shebaal-peh.mp3", note: "3/25/2024"},
              {type: "audio",title: "Making a Siyum", url: "https://www.buzzsprout.com/1899789/episodes/14362862-1-23-2024-shloimy-zelcer.mp3", note: "1/23/2024"},
              {type: "audio",title: "The 6 stages of Torah-toil", url: "https://www.buzzsprout.com/1899789/episodes/10675134-5-24-2022-shloimy-zelcer.mp3", note: "5/24/2022"},
              {type: "audio",title: "The Septuagint - PART 2", url: "https://2mishnasaday.com/wp-content/uploads/septuigint2.mp3", note: "7/8/2021"},
              {type: "audio",title: "Introduction to the Septuagint", url: "https://2mishnasaday.com/wp-content/uploads/septuigint.mp3", note: "7/1/2021"},
              {type: "audio",title: "Reconnecting our inner flame.  A Jew's internal connection to Talmud Torah", url: "https://www.buzzsprout.com/1899789/episodes/9861401-1-10-2022-shloimy-zelcer.mp3", note: "1/10/2022"},
              {type: "audio",title: "The Transmission of the Torah from Sinai until the Mishna - PART 2", url: "https://2mishnasaday.com/wp-content/uploads/torahfromsinaitomishna2.mp3", note: "11/18/2021"},
              {type: "audio",title: "The Transmission of the Torah from Sinai until the Mishna", url: "https://2mishnasaday.com/wp-content/uploads/torahfromsinaitomishna.mp3", note: "11/11/2021"}
            ] },
         { category: "Hashkafa", items: [
            {type: "audio",title: "3 lessons Lzehcer Harav Avrohom Nesanel ben Shlomo on his first Yahrtzeit", url: "https://www.buzzsprout.com/1899789/episodes/17866609-9-18-2025-shloimy-zelcer-3-lessons-lzehcer-nishmas-moireinu-harav-avrohom-nesanel-ben-shlomo-on-his-first-yahrtzeit.mp3", note: "9/18/2025"},
            {type: "audio",title: "Segulos", url: "https://2mishnasaday.com/wp-content/uploads/segulos.mp3", note: "9/4/2025"},
            {type: "audio",title: "Should the death of an evil person be celebrated?", url: "https://www.buzzsprout.com/1899789/episodes/15508964-7-31-2024-shloimy-zelcer-should-the-death-of-an-evil-person-be-celebrated.mp3", note: "7/31/2024"},
            {type: "audio",title: "◊©◊ï◊ô◊™◊ô ◊î◊≥ ◊ú◊†◊í◊ì◊ô ◊™◊û◊ô◊ì", url: "https://www.buzzsprout.com/1899789/episodes/15302666-6-24-2024-shloimy-zelcer.mp3", note: "6/24/2024"},
            {type: "audio",title: "The Torah's perspective on earthquakes", url: "https://www.buzzsprout.com/1899789/episodes/14834618-4-5-2024-shloimy-zelcer-the-torah-s-perspective-on-earthquakes.mp3", note: "4/5/2024"},
            {type: "audio",title: "When leaders fail", url: "https://2mishnasaday.com/wp-content/uploads/whenleadersfail.mp3", note: "6/18/2020"}
          ] }, 
          { category: "Other Halachos/Minhagim", items: [
            {type: "note", noteStyle: "divider", text: "Tzedakah" },
            {type: "audio",title: "Unverified collectors", url: "https://www.buzzsprout.com/1899789/episodes/16732918-3-4-2025-shloimy-zelcer-giving-tzedakah-part-2-unverified-collectors.mp3", note: "3/4/2025"},        
            {type: "audio",title: "The obligation to give", url: "https://www.buzzsprout.com/1899789/episodes/16697000-2-26-2025-shloimy-zelcer-giving-tzedakah-part-1-the-obligation-to-give.mp3", note: "2/26/2025"},
            {type: "audio",title: "Machatzis Hashekel in halacha", url: "https://www.buzzsprout.com/1899789/episodes/14624968-2-29-2024-shloimy-zelcer.mp3", note: "2/29/2024"},
            {type: "note", noteStyle: "divider", text: "Misc." },
            {type: "audio",title: "Asking two Rabbis the same Halachic question", url: "https://www.buzzsprout.com/1899789/episodes/11783471-11-29-2022-shloimy-zelcer.mp3", note: "11/29/2022"},
            {type: "audio",title: "A misconception regarding tevilas keilim", url: "https://www.buzzsprout.com/1899789/episodes/11006941-7-21-2022-shloimy-zelcer.mp3", note: "7/21/2022"},
            {type: "audio",title: "Counting Jews", url: "https://2mishnasaday.com/wp-content/uploads/countingjewsmp3.mp3", note: "8/20/2020"},
            {type: "audio",title: "Nittel Nacht", url: "https://2mishnasaday.com/wp-content/uploads/nittel.mp3", note: "12/24/2020"},
            {type: "audio",title: "Kol Isha", url: "https://2mishnasaday.com/wp-content/uploads/KOLISHA.mp3", note: "2/20/2020"}           
          ] }, 
        { category: "Jewish Timeline", items: [
            {type: "note", noteStyle: "divider", text: "Looking back" },
            {type: "audio",title: "Third time's the charm in Jewish history", url: "https://www.buzzsprout.com/1899789/episodes/15612428-8-20-2024-shloimy-zelcer-third-time-s-the-charm-in-jewish-history.mp3", note: "8/20/2024"},
            {type: "audio",title: "The avos as a blueprint for Jewish history", url: "https://www.buzzsprout.com/1899789/episodes/15606341-8-19-2024-shloimy-zelcer-the-avos-as-a-blueprint-for-jewish-history.mp3", note: "8/19/2024"},
            {type: "audio",title: "Ten lost tribes", url: "https://2mishnasaday.com/wp-content/uploads/tenlosttribes.mp3", note: "12/29/2022"},
            {type: "note", noteStyle: "divider", text: "Looking forward" },
            {type: "audio",title: "Rambam‚Äôs view on Techias Hameisim", url: "https://2mishnasaday.com/wp-content/uploads/rambamtechiashameisim.mp3", note: "3/31/2022"},
            {type: "audio",title: "Awaiting Moshiach", url: "https://2mishnasaday.com/wp-content/uploads/Moshiach6000.mp3", note: "8/13/2020"}
           ] },  
        { category: "Israel", items: [
          {type: "audio",title: "The Israeli flag in halacha", url: "https://www.buzzsprout.com/1899789/episodes/12730340-4-26-2023-shloimy-zelcer.mp3", note: "4/26/2023"},
          {type: "audio",title: "Tearing Kriyah at the Kotel", url: "https://www.buzzsprout.com/1899789/episodes/11305071-9-12-2022-shloimy-zelcer.mp3", note: "9/12/2022"},
          {type: "audio",title: "Religious Zionism", url: "https://2mishnasaday.com/wp-content/uploads/religiouszionism.mp3", note: "7/31/2019"}
        ] },
      
      ];

    window.HALACHA_DATA = PAGE_DATA;

    </script>

    <!-- ===================== -->
    <!-- RENDER TARGET         -->
    <!-- ===================== -->
    <div id="app"></div>

    <footer>
      torahmoment.com ‚Ä¢ Halacha/Hashkafah
    </footer>
  </div>
<span id="halachaTotalAll" data-total="0" hidden></span>
  <script>
    const app = document.getElementById("app");
    const searchInput = document.getElementById("searchInput");
    const resultChip = document.getElementById("resultChip");

    function escapeHtml(str){
      return (str ?? "").replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }

function enableMobileTitleExpand(){
  document.querySelectorAll(".tm-title").forEach(el => {
    el.addEventListener("click", (e) => {
      // Only toggle on mobile-sized screens
      if (window.innerWidth >= 768) return;
      e.stopPropagation(); // don't trigger play/pause
      el.classList.toggle("expanded");
    });
  });
}

    
    function getYouTubeId(url){
      if(!url) return "";
      try{
        const u = new URL(url);
        if (u.hostname.includes("youtu.be")) return u.pathname.replace("/", "");
        if (u.searchParams.get("v")) return u.searchParams.get("v");
        const parts = u.pathname.split("/").filter(Boolean);
        const embedIndex = parts.indexOf("embed");
        if (embedIndex >= 0 && parts[embedIndex+1]) return parts[embedIndex+1];
        const shortsIndex = parts.indexOf("shorts");
        if (shortsIndex >= 0 && parts[shortsIndex+1]) return parts[shortsIndex+1];
        return parts[parts.length - 1] || "";
      } catch {
        return "";
      }
    }

    function itemMatches(item, q){
      const blob = `${item.title || ""} ${item.note || ""}`.toLowerCase();
      return blob.includes(q);
    }

    function countItemsInCategory(cat){
      if (Array.isArray(cat.subcategories)) {
        return cat.subcategories.reduce((sum, s) => sum + (s.items?.length || 0), 0);
      }
      return cat.items?.length || 0;
    }

    function renderItem(item){
      const title = escapeHtml(item.title || "Item");
      const note = escapeHtml(item.note || "");
      const url = item.url || "";
      const type = (item.type || "audio").toLowerCase();

if (type === "note" && item.noteStyle === "divider") {
  return `
    <div class="tm-divider">
      <span>${escapeHtml(item.text || "")}</span>
    </div>
  `;
}

      
// NOTE / LINK ITEM (entire row clickable)
if (type === "note") {
  return `
    <div class="item">
      <div class="tm-note-row" data-url="${escapeHtml(item.url)}">
        <div class="icon">‚ÑπÔ∏è</div>
        <div>
          ${escapeHtml(item.text)}
          <span style="margin-left:6px; font-weight:600; color:var(--accent);">
            ${escapeHtml(item.linkText || "Learn more")} ‚Üí
          </span>
        </div>
      </div>
    </div>
  `;
}

      
      // AUDIO
 if (type === "audio") {
  const pid = "tm_" + Math.random().toString(36).slice(2);

  return `
    <div class="item" data-search="${escapeHtml((item.title||"") + " " + (item.note||""))}">
      
      <!-- Topic / title ABOVE player -->
   <div class="tm-title-row">
  <div class="tm-title" title="${title}">${title}</div>

  ${item.note ? `<div class="tm-note">${escapeHtml(item.note)}</div>` : ``}
</div>

      <div class="tm-row" data-audio-id="${pid}">
        <button class="tm-play" type="button" aria-label="Play/Pause">‚ñ∂</button>

        <div class="tm-main">
          <div class="tm-progress"><div></div></div>
        </div>

        <div class="tm-right">
        <div class="tm-speed">1√ó</div>
        <div class="tm-badge tm-len" style="display:none"></div>
          <div class="tm-dur">(0:00)</div>
        </div>

        <audio id="${pid}" preload="metadata" src="${escapeHtml(url)}"></audio>
      </div>
    </div>
  `;
}



     // YOUTUBE ‚Äì playlist row style (uniform with audio)
if (type === "youtube") {
  return `
    <div class="item">

      <!-- Title + note ABOVE (same as audio) -->
      <div class="tm-title-row">
        <div class="tm-title">${title}</div>
        ${item.note ? `<div class="tm-note">${escapeHtml(item.note)}</div>` : ``}
      </div>

      <div class="tm-row tm-link-row tm-youtube" data-url="${escapeHtml(item.url)}">
        <button class="tm-play">üé•</button>

        <div class="tm-main">
          <!-- empty on purpose for uniform spacing -->
        </div>

        <div class="tm-right">
          <div class="tm-badge">üé• YouTube</div>
        </div>
      </div>
    </div>
  `;
}


    



      function openMatchingSections(){
  document.querySelectorAll(".item").forEach(item => {
    const detailsSub = item.closest("details.subcat");
    const detailsCat = item.closest("details.category");

    if (detailsSub) detailsSub.setAttribute("open", "");
    if (detailsCat) detailsCat.setAttribute("open", "");
  });
}

function scrollToFirstMatch(){
  // First rendered match item (after filtering)
  const first = document.querySelector("#app .item");
  if (!first) return;

  // Give the browser a tick after opening sections
  requestAnimationFrame(() => {
    first.scrollIntoView({ behavior: "smooth", block: "start" });
  });
}


      
      // FALLBACK: link
      return `
        <div class="item" data-search="${escapeHtml((item.title||"") + " " + (item.note||""))}">
          <div class="item-meta">
            <div class="item-title">${title}</div>
            <div class="item-note">${note}</div>
          </div>
          <a class="link" href="${escapeHtml(url)}" target="_blank" rel="noopener">Open link</a>
        </div>
      `;
    }



function applyCollapseLogic(hasSearch){
  // Always start collapsed so only category names show
  document.querySelectorAll("details.category, details.subcat").forEach(d => {
    d.removeAttribute("open");
  });

  // If searching, we'll re-open only the matching sections elsewhere
  // (handled by openMatchingSections()).
}


 function openMatchingSections(){
  document.querySelectorAll(".item").forEach(item => {
    // If item is visible, open its parent sections
    const detailsSub = item.closest("details.subcat");
    const detailsCat = item.closest("details.category");

    if (detailsSub) detailsSub.setAttribute("open", "");
    if (detailsCat) detailsCat.setAttribute("open", "");
  });
}
   
    
    function renderEmpty(){
      return `<div class="empty">No results</div>`;
    }
let lastSearchWasEmpty = true;

    function render(){
      const q = (searchInput.value || "").trim().toLowerCase();
      let totalShown = 0;
      let totalAll = 0;
      // count only real shiurim
const isCountable = (i) => i?.type === "audio" || i?.type === "youtube";

      const html = PAGE_DATA.map(cat => {
      //  const totalCat = countItemsInCategory(cat);
     //   totalAll += totalCat;

        // With subcategories
if (Array.isArray(cat.subcategories)) {

  let totalCat = 0;

  const subHtml = cat.subcategories.map(sub => {
    const allItems = sub.items || [];

    // ‚úÖ what we SHOW (includes notes)
    const displayFiltered = q ? allItems.filter(i => itemMatches(i, q)) : allItems;

    // ‚úÖ what we COUNT (audio + youtube only)
    const countableAll = allItems.filter(isCountable);
    const countableFiltered = q ? countableAll.filter(i => itemMatches(i, q)) : countableAll;

    totalCat += countableAll.length;
    totalShown += countableFiltered.length;

    return `
      <details class="subcat" open>
        <summary>
          <span>${escapeHtml(sub.name)}</span>
          <span class="count">${countableFiltered.length}/${countableAll.length}</span>
        </summary>
        <div class="items">
          ${displayFiltered.length ? displayFiltered.map(renderItem).join("") : renderEmpty()}
        </div>
      </details>
    `;
  }).join("");

  totalAll += totalCat;

  return `
    <div class="card">
      <details class="category" open>
        <summary>
          <div class="cat-title">${escapeHtml(cat.category)}</div>
          <div class="count">${q ? "matches" : "total"}: ${totalCat}</div>
        </summary>
        <div class="content">
          <div class="subgrid">
            ${subHtml}
          </div>
        </div>
      </details>
    </div>
  `;
}



        // Flat category
const allItems = cat.items || [];

// ‚úÖ what we SHOW (includes notes)
const displayFiltered = q ? allItems.filter(i => itemMatches(i, q)) : allItems;

// ‚úÖ what we COUNT (audio + youtube only)
const countableAll = allItems.filter(isCountable);
const countableFiltered = q ? countableAll.filter(i => itemMatches(i, q)) : countableAll;

totalShown += countableFiltered.length;
totalAll   += countableAll.length;

return `
  <div class="card">
    <details class="category" open>
      <summary>
        <div class="cat-title">${escapeHtml(cat.category)}</div>
        <div class="count">${countableFiltered.length}/${countableAll.length}</div>
      </summary>
      <div class="content">
        ${displayFiltered.length ? displayFiltered.map(renderItem).join("") : renderEmpty()}
      </div>
    </details>
  </div>
`;

      }).join("");

     app.innerHTML = html;

const hasSearch = q.length > 0;
applyCollapseLogic(hasSearch);
if (hasSearch) openMatchingSections();

tmWirePlaylistRows();
wireYouTubeRows();
wireNoteRows();
enableMobileTitleExpand();
wireDesktopAccordion();



    

      if (!q) {
        resultChip.textContent = `Showing all (${totalAll} item${totalAll === 1 ? "" : "s"})`;
      } else {
        resultChip.textContent = `Matches: ${totalShown}`;
      }

      document.getElementById("halachaTotalAll")?.setAttribute("data-total", String(totalAll));
  document.querySelector("#halachaTotalAll")?.setAttribute("data-total", String(totalAll));

    }

function tmFmtTime(sec){
  if (!isFinite(sec) || sec < 0) return "0:00";

  sec = Math.floor(sec);

  const h = Math.floor(sec / 3600);
  const m = Math.floor((sec % 3600) / 60);
  const s = sec % 60;

  if (h > 0) {
    // hours:minutes:seconds
    return `${h}:${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
  }

  // minutes:seconds
  return `${m}:${String(s).padStart(2,"0")}`;
}


function tmWirePlayers(){
  const players = document.querySelectorAll(".tm-player");

  players.forEach(p => {
    const audio = p.querySelector("audio");
    const btn = p.querySelector(".tm-btn");
    const seek = p.querySelector(".tm-seek");
    const time = p.querySelector(".tm-time");

    if (!audio || !btn || !seek || !time) return;

    const update = () => {
      const dur = audio.duration || 0;
      const cur = audio.currentTime || 0;

      time.textContent = `${tmFmtTime(cur)} / ${dur ? tmFmtTime(dur) : "0:00"}`;

      if (dur) {
        seek.value = Math.floor((cur / dur) * 1000);
      } else {
        seek.value = 0;
      }

      btn.textContent = audio.paused ? "‚ñ∂" : "‚è∏";
    };

    const pauseOthers = () => {
      document.querySelectorAll(".tm-player audio").forEach(a => {
        if (a !== audio) a.pause();
      });
    };

    btn.addEventListener("click", async () => {
      pauseOthers();
      if (audio.paused) {
        try { await audio.play(); } catch {}
      } else {
        audio.pause();
      }
      update();
    });

    seek.addEventListener("input", () => {
      const dur = audio.duration || 0;
      if (dur) audio.currentTime = (seek.value / 1000) * dur;
    });

    audio.addEventListener("loadedmetadata", update);
    audio.addEventListener("timeupdate", update);
    audio.addEventListener("play", update);
    audio.addEventListener("pause", update);
    audio.addEventListener("ended", update);

    update();
  });
}

function wireDesktopAccordion(){
  if (!window.matchMedia("(min-width: 768px)").matches) return;

  document.querySelectorAll("details.subcat").forEach(sub => {

    // prevent double wiring
    if (sub.dataset.accordionWired === "1") return;
    sub.dataset.accordionWired = "1";

    const summary = sub.querySelector("summary");

    summary.addEventListener("click", (e) => {
      e.preventDefault(); // we control toggle manually

      const isOpen = sub.hasAttribute("open");

      const parentCat = sub.closest("details.category");
      const siblings = parentCat.querySelectorAll("details.subcat");

      // close all siblings
      siblings.forEach(s => s.removeAttribute("open"));

      // toggle this one
      if (!isOpen) {
        sub.setAttribute("open", "");
        // ‚úÖ auto-scroll opened panel into view (desktop only)
        requestAnimationFrame(() => {
          sub.scrollIntoView({ behavior: "smooth", block: "start" });
        });

      }
    });
  });
}


function wireNoteRows(){
  document.querySelectorAll(".tm-note-row").forEach(row => {
    row.addEventListener("click", () => {
      const url = row.getAttribute("data-url");
      if (url) {
        window.open(url, "_blank", "noopener");
      }
    });
  });
}

function wireYouTubeRows(){
  document.querySelectorAll(".tm-link-row").forEach(row => {
    row.addEventListener("click", () => {
      const url = row.getAttribute("data-url");
      if (url) window.open(url, "_blank", "noopener");
    });
  });
}
    
function tmWirePlaylistRows(){
  const rows = document.querySelectorAll(".tm-row");

  rows.forEach(row => {
  // ‚úÖ Prevent double-wiring (e.g., if tmWirePlaylistRows is called twice)
  if (row.dataset.wired === "1") return;
  row.dataset.wired = "1";
    
    const audio = row.querySelector("audio");
    const btn = row.querySelector(".tm-play");
    const durEl = row.querySelector(".tm-dur");
    const bar = row.querySelector(".tm-progress > div");
    const progressWrap = row.querySelector(".tm-progress");
    const speedBtn = row.querySelector(".tm-speed");
    const lenBadge = row.querySelector(".tm-len");

    if (!audio || !btn || !durEl || !bar) return;

    const pauseOthers = () => {
      document.querySelectorAll(".tm-row audio").forEach(a => {
        if (a !== audio) a.pause();
      });
    };

    const updateBtn = () => {
      btn.textContent = audio.paused ? "‚ñ∂" : "‚è∏";
    };

const updateDur = () => {
  if (audio.duration) {
    durEl.textContent = `(${tmFmtTime(audio.duration)})`;

    // ‚úÖ short vs long badge (10 min cutoff)
    if (lenBadge) {
      const isLong = audio.duration >= 600; // 10 minutes
      lenBadge.textContent = isLong ? "Long" : "Short";
      lenBadge.classList.toggle("tm-long", isLong);
      lenBadge.classList.toggle("tm-short", !isLong);
      lenBadge.style.display = "";
    }
  }
};


    const updateProgress = () => {
      if (!audio.duration) { bar.style.width = "0%"; return; }
      const pct = (audio.currentTime / audio.duration) * 100;
      bar.style.width = `${Math.max(0, Math.min(100, pct))}%`;
    };

    // Play button click
    btn.addEventListener("click", async (e) => {
      e.stopPropagation(); // don't also trigger row click
      pauseOthers();
      if (audio.paused) {
        try { await audio.play(); } catch {}
      } else {
        audio.pause();
      }
      updateBtn();
    });

    // Whole row click (toggle play/pause)
    row.addEventListener("click", async (e) => {
      // If they clicked the progress bar, let the progress handler handle it
      if (e.target.closest(".tm-progress")) return;

      pauseOthers();
      if (audio.paused) {
        try { await audio.play(); } catch {}
      } else {
        audio.pause();
      }
      updateBtn();
    });

    // Click-to-seek on the progress bar
    if (progressWrap) {
      progressWrap.addEventListener("click", (e) => {
        e.stopPropagation(); // prevent row toggle
        if (!audio.duration) return;

        const rect = progressWrap.getBoundingClientRect();
        const x = Math.max(0, Math.min(rect.width, e.clientX - rect.left));
        const pct = x / rect.width;
        audio.currentTime = pct * audio.duration;
      });
    }

    audio.addEventListener("loadedmetadata", () => {
      updateDur();
      updateProgress();
      updateBtn();
    });

    audio.addEventListener("timeupdate", updateProgress);
    audio.addEventListener("play", updateBtn);
    audio.addEventListener("pause", updateBtn);
    audio.addEventListener("ended", () => {
      updateBtn();
      bar.style.width = "0%";
    });
// Playback speed control
if (speedBtn) {
  const speeds = [1, 1.5, 2];
  let speedIndex = 0;

  speedBtn.addEventListener("click", (e) => {
    e.stopPropagation(); // don't toggle play/pause
    speedIndex = (speedIndex + 1) % speeds.length;
    const newSpeed = speeds[speedIndex];
    audio.playbackRate = newSpeed;
    speedBtn.textContent = `${newSpeed}√ó`;
  });

  audio.addEventListener("loadedmetadata", () => {
    audio.playbackRate = speeds[speedIndex];
    speedBtn.textContent = `${speeds[speedIndex]}√ó`;
  });
}

    // Initial state
    updateBtn();
  });
}



    
    searchInput.addEventListener("input", render);
    render();
  </script>
</body>
</html>
