<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Halacha/Hashkafah</title>

  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#0b63ce;
      --accent2:#0752ad;
      --chip:#eef2ff;
      --shadow: 0 10px 25px rgba(0,0,0,.06);
      --radius: 16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header{
      padding: 28px 18px 10px;
      text-align:center;
    }
    header h1{
      margin:0;
      font-size: 2rem;
      letter-spacing: .2px;
      color: var(--accent2);
    }
    header p{
      margin: 10px auto 0;
      max-width: 880px;
      color: var(--muted);
      line-height: 1.45;
    }

    .container{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px;
    }

    .topbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      margin: 12px 0 22px;
    }

    .search{
      flex: 1 1 420px;
      max-width: 560px;
      position: relative;
    }
    .search input{
      width:100%;
      padding: 12px 14px;
      border:1px solid var(--line);
      border-radius: 999px;
      outline:none;
      font-size: 15px;
      background: #fff;
      box-shadow: 0 1px 0 rgba(0,0,0,.02);
    }

    .chip{
      background: var(--chip);
      color: var(--accent2);
      border: 1px solid #dbe3ff;
      padding: 7px 12px;
      border-radius: 999px;
      font-size: 13px;
      white-space: nowrap;
    }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      margin-bottom: 14px;
    }

    details.category{
      padding: 0;
    }

    details.category > summary{
      list-style:none;
      padding: 16px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      user-select:none;
      cursor: default; /* not clicky */
    }

    details.category > summary::-webkit-details-marker{display:none}

    .cat-title{
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--accent2);
    }

    .count{
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--line);
      background: #fafafa;
      padding: 4px 10px;
      border-radius: 999px;
    }

    .content{
      border-top: 1px solid var(--line);
      padding: 14px 16px 16px;
    }

    .subgrid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 12px;
    }

    details.subcat{
      background: #fbfcff;
      border:1px solid var(--line);
      border-radius: 14px;
      overflow:hidden;
    }
    details.subcat > summary{
      list-style:none;
      padding: 12px 12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      user-select:none;
      font-weight: 650;
      color:#0f3f7a;
      cursor: default; /* not clicky */
    }
    details.subcat > summary::-webkit-details-marker{display:none}

    .items{
      border-top: 1px solid var(--line);
      padding: 10px 12px 12px;
    }

    .item{
      border:1px solid var(--line);
      background:#fff;
      border-radius: 12px;
      padding: 10px 10px;
      margin: 8px 0;
    }

    .item-meta{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items: baseline;
      flex-wrap:wrap;
      margin-bottom: 6px;
    }

    .item-title{
      font-weight: 700;
      font-size: 14px;
    }
    .item-note{
      color: var(--muted);
      font-size: 12px;
    }

    audio{
      width:100%;
      margin-top: 6px;
    }

    .link{
      display:inline-block;
      margin-top: 6px;
      font-size: 13px;
      color: var(--accent);
      text-decoration: none;
    }
    .link:hover{ text-decoration: underline; }

    .empty{
      color: var(--muted);
      font-size: 13px;
      padding: 8px 0 0;
    }

    /* Responsive YouTube embed */
    .video-wrap{
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 */
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--line);
      background: #000;
      margin-top: 8px;
    }
    .video-wrap iframe{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
    }

    footer{
      text-align:center;
      color: var(--muted);
      padding: 18px;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <header>
    <h1>Halacha/Hashkafah</h1>
    <p>
      This page supports inline MP3 audio (Buzzsprout direct .mp3 links) and embedded YouTube videos.
      Use the search box to filter by title or notes.
    </p>
  </header>

  <div class="container">
    <div class="topbar">
      <div class="search">
        <input id="searchInput" type="text" placeholder="Search (e.g., Shema, Purim, Tzedakah)..." />
      </div>
      <div class="chip" id="resultChip">Showing all</div>
    </div>

    <!-- ===================== -->
    <!-- DATA (Edit here only) -->
    <!-- ===================== -->
    <script>
      // HOW TO ADD ITEMS:
      // Add objects inside any "items: []" list.
      //
      // AUDIO (inline player):
      // { type:"audio", title:"Title", url:"https://...mp3", note:"Optional" }
      //
      // YOUTUBE (embedded):
      // { type:"youtube", title:"Title", url:"https://www.youtube.com/watch?v=VIDEOID", note:"Optional" }

      const PAGE_DATA = [
        {
          category: "Tefilah",
          subcategories: [
            {
              name: 'Talis/Tefilin',
              items: [
                {type: "audio",title: "Double Black Tefilin", url: "https://www.buzzsprout.com/1899789/episodes/18540770-1-20-2025-shloimy-zelcer-double-black-tefilin.mp3", note: "1/20/2026"}
              ]
            },
            { name: 'Shema', items: [] },
            { name: 'Shmoneh Esrei', items: [] },
            { name: 'Chazaras Hashat"z', items: [] },
            { name: 'Krias Hatorah', items: [] },
            { name: 'Kadish', items: [] },
            { name: 'Kiddush Levana', items: [] },
            { name: 'Tefilas Haderech', items: [] },
            { name: 'Conduct', items: [] },
            { name: 'Machneesei Rachamim', items: [] },
          ]
        },

        {
          category: "Yom Tov",
          subcategories: [
            { name: 'Elul', items: [] },
            { name: 'Sukkos', items: [
              { type:"youtube", title:"Sukkah heals our wounds", url:"https://youtu.be/qI8KKe3om1c", note:"9/28/2023" }
            ] },
            { name: 'Chanukah', items: [
              {type: "audio",title: "8 lesser known answers to the famous question of the Beis Yosef", url: "https://www.buzzsprout.com/1899789/episodes/11906323-12-20-2022-shloimy-zelcer.mp3", note: "12/20/2022"},
              { type:"youtube", title:"Chanukah thought", url:"https://youtu.be/gzQiPo2JKT8", note:"Optional" },
              { type:"youtube", title:"A little at a time", url:"https://youtu.be/ScsMi-d0qHs", note:"Optional" }
            ] },
            { name: 'Purim', items: [
              { type:"youtube", title:"Purim thoughts", url:"https://youtu.be/4ZhRg40--g8", note:"Optional" }
            ] },
            { name: 'Lag Baomer', items: [] },
            { name: 'Pesach', items: [
              { type:"youtube", title:"The perfect child", url:"https://youtu.be/hLOR9lvtuUE", note:"Optional" }
            ] },
          ]
        },

        { category: "Tzedakah", items: [] },
        { category: "Talmud Torah", items: [] },
        { category: "MISC.", items: [] },
      ];
    </script>

    <!-- ===================== -->
    <!-- RENDER TARGET         -->
    <!-- ===================== -->
    <div id="app"></div>

    <footer>
      torahmoment.com â€¢ Halacha/Hashkafah
    </footer>
  </div>

  <script>
    const app = document.getElementById("app");
    const searchInput = document.getElementById("searchInput");
    const resultChip = document.getElementById("resultChip");

    function escapeHtml(str){
      return (str ?? "").replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }

    function getYouTubeId(url){
      if(!url) return "";
      try{
        const u = new URL(url);
        if (u.hostname.includes("youtu.be")) return u.pathname.replace("/", "");
        if (u.searchParams.get("v")) return u.searchParams.get("v");
        const parts = u.pathname.split("/").filter(Boolean);
        const embedIndex = parts.indexOf("embed");
        if (embedIndex >= 0 && parts[embedIndex+1]) return parts[embedIndex+1];
        const shortsIndex = parts.indexOf("shorts");
        if (shortsIndex >= 0 && parts[shortsIndex+1]) return parts[shortsIndex+1];
        return parts[parts.length - 1] || "";
      } catch {
        return "";
      }
    }

    function itemMatches(item, q){
      const blob = `${item.title || ""} ${item.note || ""}`.toLowerCase();
      return blob.includes(q);
    }

    function countItemsInCategory(cat){
      if (Array.isArray(cat.subcategories)) {
        return cat.subcategories.reduce((sum, s) => sum + (s.items?.length || 0), 0);
      }
      return cat.items?.length || 0;
    }

    function renderItem(item){
      const title = escapeHtml(item.title || "Item");
      const note = escapeHtml(item.note || "");
      const url = item.url || "";
      const type = (item.type || "audio").toLowerCase();

      // AUDIO
      if (type === "audio") {
        return `
          <div class="item" data-search="${escapeHtml((item.title||"") + " " + (item.note||""))}">
            <div class="item-meta">
              <div class="item-title">${title}</div>
              <div class="item-note">${note}</div>
            </div>
            <audio controls preload="none" src="${escapeHtml(url)}"></audio>
            <a class="link" href="${escapeHtml(url)}" target="_blank" rel="noopener">Open MP3</a>
          </div>
        `;
      }

      // YOUTUBE
      if (type === "youtube") {
        const id = getYouTubeId(url);
        const embed = id ? `https://www.youtube.com/embed/${id}` : "";
        return `
          <div class="item" data-search="${escapeHtml((item.title||"") + " " + (item.note||""))}">
            <div class="item-meta">
              <div class="item-title">${title}</div>
              <div class="item-note">${note}</div>
            </div>
            ${
              embed
                ? `<div class="video-wrap"><iframe src="${embed}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>`
                : `<div class="empty">Invalid YouTube link.</div>`
            }
            <a class="link" href="${escapeHtml(url)}" target="_blank" rel="noopener">Open on YouTube</a>
          </div>
        `;
      }

      // FALLBACK: link
      return `
        <div class="item" data-search="${escapeHtml((item.title||"") + " " + (item.note||""))}">
          <div class="item-meta">
            <div class="item-title">${title}</div>
            <div class="item-note">${note}</div>
          </div>
          <a class="link" href="${escapeHtml(url)}" target="_blank" rel="noopener">Open link</a>
        </div>
      `;
    }

    function renderEmpty(){
      return `<div class="empty">No items yet. Add to the items: [] list in the PAGE_DATA block.</div>`;
    }

    function render(){
      const q = (searchInput.value || "").trim().toLowerCase();
      let totalShown = 0;
      let totalAll = 0;

      const html = PAGE_DATA.map(cat => {
        const totalCat = countItemsInCategory(cat);
        totalAll += totalCat;

        // With subcategories
        if (Array.isArray(cat.subcategories)) {
          const subHtml = cat.subcategories.map(sub => {
            const allItems = sub.items || [];
            const filtered = q ? allItems.filter(i => itemMatches(i, q)) : allItems;
            totalShown += filtered.length;

            return `
              <details class="subcat" open>
                <summary>
                  <span>${escapeHtml(sub.name)}</span>
                  <span class="count">${filtered.length}/${allItems.length}</span>
                </summary>
                <div class="items">
                  ${filtered.length ? filtered.map(renderItem).join("") : renderEmpty()}
                </div>
              </details>
            `;
          }).join("");

          return `
            <div class="card">
              <details class="category" open>
                <summary>
                  <div class="cat-title">${escapeHtml(cat.category)}</div>
                  <div class="count">${q ? "matches" : "total"}: ${q ? "" : ""}${totalCat}</div>
                </summary>
                <div class="content">
                  <div class="subgrid">
                    ${subHtml}
                  </div>
                </div>
              </details>
            </div>
          `;
        }

        // Flat category
        const allItems = cat.items || [];
        const filtered = q ? allItems.filter(i => itemMatches(i, q)) : allItems;
        totalShown += filtered.length;

        return `
          <div class="card">
            <details class="category" open>
              <summary>
                <div class="cat-title">${escapeHtml(cat.category)}</div>
                <div class="count">${filtered.length}/${allItems.length}</div>
              </summary>
              <div class="content">
                ${filtered.length ? filtered.map(renderItem).join("") : renderEmpty()}
              </div>
            </details>
          </div>
        `;
      }).join("");

      app.innerHTML = html;

      if (!q) {
        resultChip.textContent = `Showing all (${totalAll} item${totalAll === 1 ? "" : "s"})`;
      } else {
        resultChip.textContent = `Matches: ${totalShown}`;
      }
    }

    searchInput.addEventListener("input", render);
    render();
  </script>
</body>
</html>
